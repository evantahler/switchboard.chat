# Switchboard.chat

This application contains 2 main parts - the API Server (in the `/api` directory) and the Web App (in the `/web` drirectory).  The API is an [Actionhero](www.actionherojs.com) project.  The Website is a React + Next.JS application whcih is stically compiled and served from Github Pages and cached with Cloudflare.  For persistance, the API connects to a MySQL database and Redis.  

Vendors Utilized:
* Twillio (SMS + MMS)
* Stripe (Payment)
* Sendgrid (Email Notifications)
* Heroku (Hosting (API))
* AWS (Asset Hosting for User Uploads)
* Google (Sign in with Google)
* Mailchimp (Newsletter + Marketing) 
* New Relic (Application Monitoring)

All settings (API Keys, Database Credentials, etc) are controlled by the Environment (a 12-factor app https://12factor.net/).  Locally, you can manage this via a `.env` file.

## To install:
(assuming you have [node](http://nodejs.org/) and NPM installed) - `yarn install` and `cd mobile && yarn install`.  We use Yarn workspaces to manage the monorepo's dependencies.  

Set up your environment variables.  First, `cp .env.example .env` and fill them in

## Installing Mysql 5 on OSX:
* `brew install mysql@5.7`
* `brew install mysql-client`
* `echo 'export PATH="/usr/local/opt/mysql-client/bin:$PATH"' >> ~/.bash_profile` + `source ~/.bash_profile`

Then, create the database
* `mysql -u root -e "create database switchboard_development"`

## To Run:
`brew install heroku` which we will use to run the app.  You can also use `foreman`
`heroku local` - will start both the next frontend server and the api backend server from Procfile

## To Test:
`./api/bin/create-test-databases`
`yarn test`

## Mobile Setup
We do not automatically deploy the mobile app

```
brew cask install fastlane
```

* Ensure that the app is part of the team "Delicious Hat LLC"


## Documents
Legal docs are generated by Termly, but they want you to use thier silly embed tool. To convert them:
1. View the embed page and "save as html" in firefox
2. Convert the downloaded HTML to Markdown via https://domchristie.github.io/turndown/ ; delete the extra stuff like styles and the Termly footer
3. save as a `.md` file in this project in the "documents" top-level folder
4. React will conver the MD to HTML
